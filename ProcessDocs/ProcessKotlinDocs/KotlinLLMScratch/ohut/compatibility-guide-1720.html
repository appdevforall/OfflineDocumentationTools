<html>
 <head>
  <meta charset="utf-8"/>
  <title>
   Kotlin Documentation
  </title>
  <link href="style.css" rel="stylesheet"/>
 </head>
 <body>
  <div style="text-align: center; margin-bottom: 1em;">
   <a href="toc.html" style="font-size: 24px; text-decoration: none;">
    Menu
   </a>
  </div>
  <article class="article" data-shortcut-switcher="inactive">
   <h1 data-toc="compatibility-guide-1720" id="compatibility-guide-1720.md">
    Compatibility guide for Kotlin 1.7.20
   </h1>
   <p id="-tdjfkc_2">
    <span class="emphasis" id="-tdjfkc_7">
     <a data-tooltip="Language design is cast in stone," href="kotlin-evolution-principles.html" id="-tdjfkc_9" style="color: blue;">
      Keeping the Language Modern
     </a>
    </span>
    and
    <span class="emphasis" id="-tdjfkc_8">
     <a data-tooltip="Language design is cast in stone," href="kotlin-evolution-principles.html" id="-tdjfkc_10" style="color: blue;">
      Comfortable Updates
     </a>
    </span>
    are among the fundamental principles in Kotlin Language Design. The former says that constructs which obstruct language evolution should be removed, and the latter says that this removal should be well-communicated beforehand to make code migration as smooth as possible.
   </p>
   <p id="-tdjfkc_3">
    Usually incompatible changes happen only in feature releases, but this time we have to introduce two such changes in an incremental release to limit spread of the problems introduced by changes in Kotlin 1.7.
   </p>
   <p id="-tdjfkc_4">
    This document summarizes them, providing a reference for migration from Kotlin 1.7.0 and 1.7.10 to Kotlin 1.7.20.
   </p>
   <section class="chapter">
    <h2 data-toc="basic-terms" id="basic-terms">
     Basic terms
    </h2>
    <p id="-tdjfkc_11">
     In this document we introduce several kinds of compatibility:
    </p>
    <ul class="list _bullet" id="-tdjfkc_12">
     <li class="list__item" id="-tdjfkc_14">
      <p id="-tdjfkc_17">
       <span class="emphasis" id="-tdjfkc_18">
        source
       </span>
       : source-incompatible change stops code that used to compile fine (without errors or warnings) from compiling anymore
      </p>
     </li>
     <li class="list__item" id="-tdjfkc_15">
      <p id="-tdjfkc_19">
       <span class="emphasis" id="-tdjfkc_20">
        binary
       </span>
       : two binary artifacts are said to be binary-compatible if interchanging them doesn't lead to loading or linkage errors
      </p>
     </li>
     <li class="list__item" id="-tdjfkc_16">
      <p id="-tdjfkc_21">
       <span class="emphasis" id="-tdjfkc_22">
        behavioral
       </span>
       : a change is said to be behavioral-incompatible if the same program demonstrates different behavior before and after applying the change
      </p>
     </li>
    </ul>
    <p id="-tdjfkc_13">
     Remember that those definitions are given only for pure Kotlin. Compatibility of Kotlin code from the other languages perspective (for example, from Java) is out of the scope of this document.
    </p>
   </section>
   <section class="chapter">
    <h2 data-toc="language" id="language">
     Language
    </h2>
    <section class="chapter">
     <h3 data-toc="rollback-attempt-to-fix-proper-constraints-processing" id="rollback-attempt-to-fix-proper-constraints-processing">
      Rollback attempt to fix proper constraints processing
     </h3>
     <aside class="prompt" data-title="" data-type="tip" id="-tdjfkc_25">
      <p id="-tdjfkc_26">
       <span class="control" id="-tdjfkc_32">
        Issue
       </span>
       :
       <a data-external="true" href="https://youtrack.jetbrains.com/issue/KT-53813" id="-tdjfkc_33" rel="noopener noreferrer" style="color: red;" target="_blank">
        KT-53813
       </a>
      </p>
      <p id="-tdjfkc_27">
       <span class="control" id="-tdjfkc_34">
        Component
       </span>
       : Core language
      </p>
      <p id="-tdjfkc_28">
       <span class="control" id="-tdjfkc_35">
        Incompatible change type
       </span>
       : source
      </p>
      <p id="-tdjfkc_29">
       <span class="control" id="-tdjfkc_36">
        Short summary
       </span>
       : Rollback an attempt of fixing issues in type inference constraints processing appeared in 1.7.0 after implementing the change described in
       <a data-external="true" href="https://youtrack.jetbrains.com/issue/KT-52668" id="-tdjfkc_37" rel="noopener noreferrer" style="color: red;" target="_blank">
        KT-52668
       </a>
       . The attempt was made in 1.7.10, but it in turn introduced new problems.
      </p>
      <p id="-tdjfkc_30">
       <span class="control" id="-tdjfkc_38">
        Deprecation cycle
       </span>
       :
      </p>
      <ul class="list _bullet" id="-tdjfkc_31">
       <li class="list__item" id="-tdjfkc_39">
        <p id="-tdjfkc_40">
         1.7.20: Rollback to 1.7.0 behavior
        </p>
       </li>
      </ul>
     </aside>
    </section>
    <section class="chapter">
     <h3 data-toc="forbid-some-builder-inference-cases-to-avoid-problematic-interaction-with-multiple-lambdas-and-resolution" id="forbid-some-builder-inference-cases-to-avoid-problematic-interaction-with-multiple-lambdas-and-resolution">
      Forbid some builder inference cases to avoid problematic interaction with multiple lambdas and resolution
     </h3>
     <aside class="prompt" data-title="" data-type="tip" id="-tdjfkc_41">
      <p id="-tdjfkc_42">
       <span class="control" id="-tdjfkc_49">
        Issue
       </span>
       :
       <a data-external="true" href="https://youtrack.jetbrains.com/issue/KT-53797" id="-tdjfkc_50" rel="noopener noreferrer" style="color: red;" target="_blank">
        KT-53797
       </a>
      </p>
      <p id="-tdjfkc_43">
       <span class="control" id="-tdjfkc_51">
        Component
       </span>
       : Core language
      </p>
      <p id="-tdjfkc_44">
       <span class="control" id="-tdjfkc_52">
        Incompatible change type
       </span>
       : source
      </p>
      <p id="-tdjfkc_45">
       <span class="control" id="-tdjfkc_53">
        Short summary
       </span>
       : Kotlin 1.7 introduced a feature called unrestricted builder inference, so that even the lambdas passed to parameters not annotated with
       <code class="code" id="-tdjfkc_54">
        @BuilderInference
       </code>
       could benefit from the builder inference. However, that could cause several problems if more than one such lambda occurred in a function invocation.
      </p>
      <p id="-tdjfkc_46">
       Kotlin 1.7.20 will report an error if more than one lambda function having the corresponding parameter not annotated with
       <code class="code" id="-tdjfkc_55">
        @BuilderInference
       </code>
       requires using builder inference to complete inferring the types in the lambda.
      </p>
      <p id="-tdjfkc_47">
       <span class="control" id="-tdjfkc_56">
        Deprecation cycle
       </span>
       :
      </p>
      <ul class="list _bullet" id="-tdjfkc_48">
       <li class="list__item" id="-tdjfkc_57">
        <p id="-tdjfkc_58">
         1.7.20: report an error on such lambda functions,
         <br/>
         <code class="code" id="-tdjfkc_60">
          -XXLanguage:+NoBuilderInferenceWithoutAnnotationRestriction
         </code>
         can be used to temporarily revert to the pre-1.7.20 behavior
        </p>
       </li>
      </ul>
     </aside>
    </section>
   </section>
   <div class="last-modified">
    19 April 2025
   </div>
   <div data-feedback-placeholder="true">
   </div>
  </article>
 </body>
</html>
